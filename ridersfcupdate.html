<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Competition Admin Panel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        h2 {
            text-align: center;
            color: #333;
        }

        section {
            margin: 30px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            width: 80%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        input, select, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        button {
            background-color: #4CAF50;
            color: white;
            border: none;
        }

        button:hover {
            background-color: #45a049;
        }

        select {
            background-color: #f9f9f9;
        }

        .team-logo {
            width: 50px;
            height: 50px;
        }
/* Fixture Item Styles */
.fixture-item {
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
    padding: 20px;
    transition: transform 0.3s ease;
}

.fixture-item:hover {
    transform: scale(1.02);
}

/* Header with 3D Effect */
.fixture-header h4 {
    font-size: 24px;
    font-weight: bold;
    text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
    color: #333;
}

/* Teams and Logos Styling */
.teams {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px 0;
}

.team {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 15px;
}

.team-logo {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-right: 10px;
}

.vs {
    font-size: 20px;
    font-weight: bold;
    color: #666;
}

/* Match Date and Time Styling */
.match-date-time p {
    font-size: 16px;
    color: #555;
    margin: 5px 0;
}

.match-date-time strong {
    font-weight: bold;
}

/* Button Styling */
.button-container {
    margin-top: 20px;
    display: flex;
    justify-content: space-between;
}

.fixture-button {
    padding: 10px 15px;
    font-size: 16px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    border-radius: 5px;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
}

.fixture-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
}

/* Individual Button Styles */
.edit-btn {
    background-color: #4CAF50;
    color: white;
}

.delete-btn {
    background-color: #f44336;
    color: white;
}

.stats-btn {
    background-color: #2196F3;
    color: white;
}

/* 3D Button Hover Effects */
.fixture-button:active {
    transform: scale(0.95);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

        .team-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
        }

        .team-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .team-header h3 {
            margin: 0;
        }

/* Styling for the teams list container */
#teams-list {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    padding: 20px;
    justify-content: center;
}

/* Styling for each team card */
.team-card {
    width: 100%;
    max-width: 300px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #fff;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
    transition: transform 0.2s ease-in-out;
}

.team-card:hover {
    transform: scale(1.05);
}

/* Card Header */
.card-header {
    background-color: #f0f0f0;
    padding: 15px;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.team-logo {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border-radius: 50%;
    margin-bottom: 10px;
}

.card-header h3 {
    margin: 0;
    font-size: 18px;
    color: #333;
}

/* Card Body */
.card-body {
    padding: 10px;
    color: #333;
}

.card-body p {
    margin: 5px 0;
    font-size: 14px;
}

/* This CSS will make the player list display in two columns */
.player-list {
    display: grid;
    grid-template-columns: repeat(2, 1fr);  /* Create two equal columns */
    gap: 10px;  /* Add some space between items */
    list-style-type: none;  /* Remove default list bullets */
    padding: 0;  /* Remove default padding */
}

/* Optional style to make the player list look more organized */
.player-list li {
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 10px;
    text-align: center;
}



/* Card Footer */
.card-footer {
    display: flex;
    justify-content: space-evenly;
    padding: 10px;
    background-color: #f9f9f9;
    border-top: 1px solid #ddd;
}

.team-button {
    padding: 8px 12px;
    font-size: 14px;
    border: none;
    border-radius: 5px;
    background-color: #007bff;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
}

/* Basic Styles for Fixture Container (Grid Layout) */
#fixtures-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); /* Adjust the card width */
    gap: 20px; /* Space between fixture items */
    margin: 20px;
}

/* Fixture Item Frame */
.fixture-item {
    border: 2px solid #ddd;
    border-radius: 10px;
    background-color: #fff;
    padding: 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    display: grid;
    grid-template-rows: auto 1fr auto; /* Header, body, footer */
    grid-template-columns: 1fr 3fr 1fr; /* Layout for team logos, score and stats */
    align-items: center;
    justify-items: center;
}

/* Fixture Header */
.fixture-header {
    grid-column: 1 / -1; /* Span the whole row */
    text-align: center;
}

.fixture-header h4 {
    font-size: 1.4em;
    font-weight: bold;
    margin-bottom: 10px;
}

/* Teams Section */
.teams {
    grid-column: 1 / -1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.team {
    text-align: center;
    flex: 1;
}

.team-logo {
    width: 60px;
    height: 60px;
    margin-bottom: 10px;
}

/* Score in 3D Font */
.score {
    font-size: 2.5em;
    font-weight: bold;
    color: #333;
    text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2); /* 3D effect */
}

/* VS Separator */
.vs {
    font-size: 1.5em;
    font-weight: bold;
    margin: 0 10px;
}

/* Match Date and Time */
.match-datetime {
    text-align: center;
    margin: 15px 0;
}

.match-datetime p {
    font-size: 1.1em;
    margin: 5px 0;
}

/* Match Stats */
.match-stats {
    grid-column: 1 / -1; /* Span the whole row */
    text-align: center;
    margin: 10px 0;
}

.match-stats p {
    font-size: 1.1em;
}

/* Status (Centered) */
.status {
    text-align: center;
    font-size: 1.2em;
    font-weight: bold;
    color: #ff5733; /* Status color */
    margin-top: 10px;
}

/* Action Buttons */
.match-actions {
    grid-column: 1 / -1;
    display: flex;
    justify-content: space-around;
    margin-top: 10px;
}

.fixture-button {
    padding: 10px 15px;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
}

.fixture-button:hover {
    background-color: #0056b3;
}

/* Responsive Design for Smaller Screens */
@media (max-width: 768px) {
    /* On smaller screens, make the teams column stack vertically */
    .teams {
        flex-direction: column;
        align-items: center;
    }

    .vs {
        margin: 10px 0;
    }

    .match-stats p {
        font-size: 1em;
    }
}

@media (max-width: 480px) {
    /* On very small screens, reduce card padding and font size */
    .fixture-item {
        padding: 15px;
    }

    .fixture-header h4 {
        font-size: 1.2em;
    }

    .team-logo {
        width: 50px;
        height: 50px;
    }

    .score {
        font-size: 2em;
    }

    .match-datetime p, .match-stats p {
        font-size: 1em;
    }

    .fixture-button {
        font-size: 0.9em;
    }
}

    </style>
</head>
<body>

    <section id="team-section">
        <h2>Create or Manage Teams</h2>
        <form id="team-form">
            <input type="text" id="team-name" placeholder="Team Name" required>
            <input type="text" id="coach-name" placeholder="Coach Name" required>
            <input type="text" id="player-names" placeholder="Player Names (comma separated)" required>
            <input type="text" id="team-logo" placeholder="Enter Logo URL (e.g., /images/logo.png)" required>
            <button type="submit">Add Team</button>
        </form>

        <div class="team-header">
            <h3>Existing Teams</h3>
        </div>
        <div id="teams-list" class="team-list"></div>
    </section>

    <section id="fixture-section" style="background-color: #f1f8e9;">
        <h2>Create or Manage Fixtures</h2>
<form id="fixture-form">
    <input type="text" id="event-name" placeholder="Event Name" required>
    <select id="first-team-dropdown"></select>
    <select id="second-team-dropdown"></select>
    <input type="date" id="match-date" required>
    <input type="time" id="match-time" required>
    <button type="submit">Create Fixture</button>
</form>

        <h3>Existing Fixtures</h3>
        <div id="fixtures-list"></div>
    </section>



    <!-- Firebase SDK v8 CDN for non-modular use -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDr1XsWltrYOMXT7_MqylD8bOTGjikmYzE",
        authDomain: "riders-5ad93.firebaseapp.com",
        projectId: "riders-5ad93",
        storageBucket: "riders-5ad93.appspot.com",
        messagingSenderId: "956987352089",
        appId: "1:956987352089:web:bee471f0cb74626bbb7688"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Create a Team
    document.getElementById("team-form").addEventListener("submit", (e) => {
        e.preventDefault();
        const teamName = document.getElementById("team-name").value;
        const coachName = document.getElementById("coach-name").value;
        const playerNames = document.getElementById("player-names").value.split(",");
        const logoURL = document.getElementById("team-logo").value;

        // Save team data to Firestore
        const team = {
            name: teamName,
            coach: coachName,
            players: playerNames,
            logo: logoURL, // Save logo URL in Firestore
        };

        db.collection("teams").add(team)
            .then(() => {
                alert("Team created successfully!");
                loadTeams();
            })
            .catch((error) => {
                alert("Error creating team: " + error.message);
            });
    });

    // Load all teams and display in list with edit and delete functionality
    function loadTeams() {
        db.collection("teams").get().then((snapshot) => {
            const teamList = document.getElementById("teams-list");
            teamList.innerHTML = ""; // Clear existing teams

            snapshot.forEach(doc => {
                const team = doc.data();
                
                // Create a card for each team
                const teamCard = document.createElement("div");
                teamCard.classList.add("team-card");
                
                teamCard.innerHTML = `
                    <div class="card-header">
                        <img src="${team.logo}" class="team-logo" alt="${team.name} Logo"> <!-- Display the team logo -->
                        <h3>${team.name}</h3>
                    </div>
                    <div class="card-body">
                        <p><strong>Coach:</strong> ${team.coach}</p>
                        <p><strong>Players:</strong></p>
                        <ul class="player-list">
                            ${team.players.map(player => `<li>${player}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="card-footer">
                        <button class="team-button" onclick="editTeam('${doc.id}')">Edit</button>
                        <button class="team-button" onclick="deleteTeam('${doc.id}')">Delete</button>
                    </div>
                `;

                teamList.appendChild(teamCard);
            });
        });
    }

    // Edit team
    function editTeam(teamId) {
        db.collection("teams").doc(teamId).get().then(doc => {
            const team = doc.data();
            document.getElementById("team-name").value = team.name;
            document.getElementById("coach-name").value = team.coach;
            document.getElementById("player-names").value = team.players.join(", ");
            document.getElementById("team-logo").value = team.logo; // Set the logo URL in the form for editing
        });
    }

    // Delete team
    function deleteTeam(teamId) {
        db.collection("teams").doc(teamId).delete()
            .then(() => {
                alert("Team deleted successfully!");
                loadTeams();
            })
            .catch((error) => {
                alert("Error deleting team: " + error.message);
            });
    }
// Load teams for fixture dropdowns
function loadTeamDropdowns() {
    const firstTeamDropdown = document.getElementById("first-team-dropdown");
    const secondTeamDropdown = document.getElementById("second-team-dropdown");

    db.collection("teams").get().then((snapshot) => {
        firstTeamDropdown.innerHTML = "";
        secondTeamDropdown.innerHTML = "";

        snapshot.forEach(doc => {
            const team = doc.data();
            const option1 = document.createElement("option");
            const option2 = document.createElement("option");

            option1.value = doc.id;
            option1.textContent = team.name;
            firstTeamDropdown.appendChild(option1);

            option2.value = doc.id;
            option2.textContent = team.name;
            secondTeamDropdown.appendChild(option2);
        });
    });
}

// Create fixture
document.getElementById("fixture-form").addEventListener("submit", (e) => {
    e.preventDefault();
    const eventName = document.getElementById("event-name").value;
    const firstTeamId = document.getElementById("first-team-dropdown").value;
    const secondTeamId = document.getElementById("second-team-dropdown").value;
    const matchDate = document.getElementById("match-date").value;

    // Save fixture to Firestore
    db.collection("fixtures").add({
        event: eventName,
        firstTeamId: firstTeamId,
        secondTeamId: secondTeamId,
        date: matchDate,
        stats: { 
            homeScore: 0, awayScore: 0, 
            ballPossession: "0-0", yellowCards: "0-0", redCards: "0-0", status: "not-started" 
        }
    })
    .then(() => {
        alert("Fixture created successfully!");
        loadFixtures();
    })
    .catch((error) => {
        alert("Error creating fixture: " + error.message);
    });
});

// Load fixtures and display them with team logos and match stats
function loadFixtures() {
    db.collection("fixtures").get().then((snapshot) => {
        const fixtureList = document.getElementById("fixtures-list");
        fixtureList.innerHTML = "";  // Clear previous fixtures

        snapshot.forEach(doc => {
            const fixture = doc.data();
            const firstTeamId = fixture.firstTeamId;
            const secondTeamId = fixture.secondTeamId;

            // Fetch team names and logos based on team IDs
            const firstTeamNamePromise = db.collection("teams").doc(firstTeamId).get();
            const secondTeamNamePromise = db.collection("teams").doc(secondTeamId).get();

            // Wait for both promises to resolve
            Promise.all([firstTeamNamePromise, secondTeamNamePromise]).then(([firstTeamDoc, secondTeamDoc]) => {
                const firstTeamName = firstTeamDoc.data().name;
                const secondTeamName = secondTeamDoc.data().name;
                const firstTeamLogo = firstTeamDoc.data().logo; // Ensure we are using the correct logo field
                const secondTeamLogo = secondTeamDoc.data().logo;

                const stats = fixture.stats; // Access match statistics
                const matchDate = new Date(fixture.date); // Convert the date to a Date object for better formatting
                const matchTime = matchDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}); // Format time
                const matchDateFormatted = matchDate.toLocaleDateString(); // Format date

                // Render the fixture with team names, logos, date, time, and stats
                const fixtureDiv = document.createElement("div");
                fixtureDiv.classList.add("fixture-item");
                fixtureDiv.innerHTML = `
                    <div class="fixture-header">
                        <h4 class="event-name">${fixture.event}</h4>
                    </div>
                    <div class="fixture-body">
                        <div class="teams">
                            <div class="team">
                                <img src="${firstTeamLogo}" alt="${firstTeamName} logo" class="team-logo">
                                <p>${firstTeamName}</p>
                                <p class="score home-score">${stats.homeScore}</p>
                            </div>
                            <div class="vs">VS</div>
                            <div class="team">
                                <img src="${secondTeamLogo}" alt="${secondTeamName} logo" class="team-logo">
                                <p>${secondTeamName}</p>
                                <p class="score away-score">${stats.awayScore}</p>
                            </div>
                        </div>

                        <!-- Separate Date and Time -->
                        <div class="match-datetime">
                            <p class="match-date"><strong>Date:</strong> ${matchDateFormatted}</p>
                            <p class="match-time"><strong>Time:</strong> ${matchTime}</p>
                        </div>

                        <div class="match-stats">
                            <p><strong>Ball Possession:</strong> ${stats.ballPossession}</p>
                            <p><strong>Yellow Cards:</strong> ${stats.yellowCards}</p>
                            <p><strong>Red Cards:</strong> ${stats.redCards}</p>
                            <p><strong>Status:</strong> ${stats.status}</p>
                        </div>

                        <div class="match-actions">
                            <button class="fixture-button edit-stats-btn" onclick="editStats('${doc.id}')">Edit Stats</button>
                            <button class="fixture-button delete-btn" onclick="deleteFixture('${doc.id}')">Delete</button>
                        </div>
                    </div>
                `;
                fixtureList.appendChild(fixtureDiv);
            }).catch(error => {
                console.error("Error fetching team data:", error);
            });
        });
    });
}

// Function to edit match stats
function editStats(fixtureId) {
    const fixtureRef = db.collection("fixtures").doc(fixtureId);
    fixtureRef.get().then(doc => {
        const fixture = doc.data();

        // Prompt the user to edit match statistics
        const homeScore = prompt("Enter Home Team Score:", fixture.stats.homeScore);
        const awayScore = prompt("Enter Away Team Score:", fixture.stats.awayScore);
        const ballPossession = prompt("Enter Ball Possession (Home-Away):", fixture.stats.ballPossession);
        const yellowCards = prompt("Enter Yellow Cards (Home-Away):", fixture.stats.yellowCards);
        const redCards = prompt("Enter Red Cards (Home-Away):", fixture.stats.redCards);
        const status = prompt("Enter Match Status (e.g., 'Completed', 'In Progress'):", fixture.stats.status);

        // Update stats in Firestore
        fixtureRef.update({
            stats: {
                homeScore: parseInt(homeScore, 10),
                awayScore: parseInt(awayScore, 10),
                ballPossession: ballPossession,
                yellowCards: yellowCards,
                redCards: redCards,
                status: status
            }
        }).then(() => {
            alert("Match statistics updated successfully!");
            loadFixtures();  // Reload fixtures to show updated stats
        }).catch((error) => {
            alert("Error updating match stats: " + error.message);
        });
    });
}

// Delete a fixture
function deleteFixture(fixtureId) {
    db.collection("fixtures").doc(fixtureId).delete()
        .then(() => {
            alert("Fixture deleted successfully!");
            loadFixtures();
        })
        .catch((error) => {
            alert("Error deleting fixture: " + error.message);
        });
}
    // Initial Load of Teams and Fixtures
    loadTeams();
    loadTeamDropdowns();
    loadFixtures();
</script>

</body>
</html>